steps:
  # üîç An√°lisis SonarQube usando Maven
  - name: 'gcr.io/cloud-builders/mvn'
    entrypoint: 'bash'
    secretEnv: ['TOKEN_SONRQUBE_GITOPS']
    args:
      - '-c'
      - |
        mvn sonar:sonar \
          -Dsonar.projectKey=my-service-dev \
          -Dsonar.host.url=https://sonarqube.mycompany.com \
          -Dsonar.login=${TOKEN_SONRQUBE_GITOPS}

# üîê Secci√≥n obligatoria: definici√≥n del secreto desde Secret Manager
availableSecrets:
  secretManager:
    - versionName: projects/fiery-synthesis-472821-m2/secrets/TOKEN_SONRQUBE_GITOPS/versions/latest
      env: 'TOKEN_SONRQUBE_GITOPS'

# ‚öôÔ∏è Opcional: configuraciones adicionales
timeout: 900s
options:
  logging: CLOUD_LOGGING_ONLY